<!DOCTYPE html>
<html lang="en-us">

<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.67.1" />

    <title>Data manipulation - KrakenD API Gateway</title>
    <meta itemprop="name" content="Data manipulation - KrakenD API Gateway">

    
    <meta property="description" content="Data manipulation - KrakenD API Gateway">
    <meta itemprop="description" content="Data manipulation - KrakenD API Gateway">
    

    
    <meta itemprop="image" content="https://www.krakend.io/images/logo.png">
    



<meta property="og:title" content="Data manipulation" />
<meta property="og:description" content="Filtering When you offer a KrakenD endpoint you can decide to show only a subset of the fields coming from the backends&rsquo; response or alter the structure of the content provided. There are a number of different reasons you might want to use this functionality, but we strongly encourage you to use it to save user&rsquo;s bandwidth and increase load and render times.
There are two different strategies you can use to filter content:" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.krakend.io/docs/backends/data-manipulation/" />
<meta property="og:image" content="https://www.krakend.io/images/krakend-waves.png"/>
<meta property="article:published_time" content="2016-09-30T00:00:00+00:00" />
<meta property="article:modified_time" content="2019-05-03T00:00:00+00:00" /><meta property="og:site_name" content="KrakenD - Open source API Gateway" />



<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://www.krakend.io/images/krakend-waves.png"/>

<meta name="twitter:title" content="Data manipulation"/>
<meta name="twitter:description" content="Filtering When you offer a KrakenD endpoint you can decide to show only a subset of the fields coming from the backends&rsquo; response or alter the structure of the content provided. There are a number of different reasons you might want to use this functionality, but we strongly encourage you to use it to save user&rsquo;s bandwidth and increase load and render times.
There are two different strategies you can use to filter content:"/>





<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">

<link rel="stylesheet" href="/dist/styles.css">


<link rel="icon" type="image/png" href="/favicon/favicon-196x196.png" sizes="196x196" />
<link rel="icon" type="image/png" href="/favicon/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/png" href="/favicon/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="/favicon/favicon-16x16.png" sizes="16x16" />
<link rel="icon" type="image/png" href="/favicon/favicon-128.png" sizes="128x128" />
</head>

<body class="krakend page-51e5cbbb55ee09adc6e5a9b79bdfce28">
    
<div class="announcement">
	<p>
		<i class="fa fa-bell"></i> KrakenD 1.1 with Kafka integration is out!. <a href="/blog/krakend-1.1-release-notes/">Release notes</a>.
		 
	</p>
</div>

    <div class="top-bar">
  <div class="container my-2">
    <nav class="navbar navbar-expand-lg navbar-light">
      <a class="navbar-brand" href="/" title="Home">
        <img class="mr-4" src="/images/logo.png" alt="" width="180">
      </a>
      <div class="collapse navbar-collapse" id="navbarMenu">
        <ul class="mega-dropdown navbar-nav mr-auto">
          

          <li class="nav-item">
            <a class="nav-link" href="/features/">Features</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/enterprise/">Enterprise</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/support/">Support</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/docs/overview/introduction/">Docs</a>
          </li>
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li class="nav-item"><a class="nav-link" href="/partners/">Partners</a></li>
              <li class="nav-item"><a class="nav-link" href="/team/">About us</a></li>
              <li class="nav-item"><a class="nav-link" href="https://www.krakend.io/case-study/">Case studies</a></li>
              <li class="nav-item"><a class="nav-link" href="/blog/">Blog</a></li>
            </ul>
          </li>
        </ul>
      </div>


      <div class="github d-none d-lg-block">
        <a class="nav-link github-button" href="https://github.com/devopsfaith/krakend" data-show-count="true"
          aria-label="Star devopsfaith/krakend on GitHub">Star</a>
      </div>
      <div class="download d-none d-lg-block">
          <a class="btn btn-sm" href="/download/">Downloads</a>
      </div>
      <div class="designer d-none d-lg-block">
        <a class="btn btn-sm" href="https://designer.krakend.io">Designer</a>
      </div>
      


      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMenu" aria-controls="navbarMenu"
        aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
    </nav>
  </div>
</div>
    <div class="documentation mr-3">
        <div class="row">
            <div class="col-md-3">
                
                <div class="sidebar ml-3 mb-3">
    <h6 class="header">Documentation</h6>
    <ul class="nav menu">

        
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-0" role="button" aria-expanded="false"
                aria-controls="menu-0" class="nav-link parent">
                Getting Started
            </a>
            <div class="collapse" id="menu-0">
                <ul class="nav flex-column">
                    
                    <li class="nav-item child">
                        <a href="/docs/overview/introduction/" class="nav-link children ">Introduction</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/overview/installing/" class="nav-link children ">Installing KrakenD</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/overview/usage/" class="nav-link children ">Using KrakenD</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/overview/krakend-vs-krakend-ce/" class="nav-link children ">KrakenD vs. KrakenD-CE</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/overview/playground/" class="nav-link children ">The Playground</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-1" role="button" aria-expanded="false"
                aria-controls="menu-1" class="nav-link parent">
                Configuration file
            </a>
            <div class="collapse" id="menu-1">
                <ul class="nav flex-column">
                    
                    <li class="nav-item child">
                        <a href="/docs/configuration/overview/" class="nav-link children ">Configuration overview</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/configuration/structure/" class="nav-link children ">File structure</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/configuration/flexible-config/" class="nav-link children ">Multiple configuration files</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/configuration/supported-formats/" class="nav-link children ">Supported file formats</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-2" role="button" aria-expanded="false"
                aria-controls="menu-2" class="nav-link parent">
                Command line commands
            </a>
            <div class="collapse" id="menu-2">
                <ul class="nav flex-column">
                    
                    <li class="nav-item child">
                        <a href="/docs/commands/run/" class="nav-link children ">Run</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/commands/check/" class="nav-link children ">Check</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-3" role="button" aria-expanded="false"
                aria-controls="menu-3" class="nav-link parent">
                Service settings
            </a>
            <div class="collapse" id="menu-3">
                <ul class="nav flex-column">
                    
                    <li class="nav-item child">
                        <a href="/docs/service-settings/tls/" class="nav-link children ">TLS</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/service-settings/security/" class="nav-link children ">Security</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-4" role="button" aria-expanded="false"
                aria-controls="menu-4" class="nav-link parent">
                Endpoints
            </a>
            <div class="collapse" id="menu-4">
                <ul class="nav flex-column">
                    
                    <li class="nav-item child">
                        <a href="/docs/endpoints/creating-endpoints/" class="nav-link children ">Creating endpoints</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/endpoints/rate-limit/" class="nav-link children ">Rate Limits</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/endpoints/response-manipulation/" class="nav-link children ">Response manipulation</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/endpoints/concurrent-requests/" class="nav-link children ">Concurrent Requests</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/endpoints/parameter-forwarding/" class="nav-link children ">Parameter forwarding</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/endpoints/debug-endpoint/" class="nav-link children ">Debug endpoint</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/endpoints/content-types/" class="nav-link children ">Content Types</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/endpoints/no-op/" class="nav-link children ">No-op (proxy only)</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/endpoints/sequential-proxy/" class="nav-link children ">Sequential Proxy (chain reqs.)</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/endpoints/static-proxy/" class="nav-link children ">Static responses (stubs)</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/endpoints/common-expression-language-cel/" class="nav-link children ">Checking requests and responses</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/endpoints/lua/" class="nav-link children ">Lua scripting</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/endpoints/health/" class="nav-link children ">Health endpoint</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-5" role="button" aria-expanded="true"
                aria-controls="menu-5" class="nav-link parent active">
                Backends
            </a>
            <div class="collapse show" id="menu-5">
                <ul class="nav flex-column menu-open">
                    
                    <li class="nav-item child">
                        <a href="/docs/backends/overview/" class="nav-link children ">Backends Overview</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/backends/data-manipulation/" class="nav-link children active">Data manipulation</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/backends/rate-limit/" class="nav-link children ">Proxy rate limit</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/backends/circuit-breaker/" class="nav-link children ">Circuit Breaker</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/backends/supported-encodings/" class="nav-link children ">Supported encodings</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/backends/caching/" class="nav-link children ">Caching responses</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/backends/shadow-backends/" class="nav-link children ">Traffic shadowing/mirroring</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/backends/flatmap/" class="nav-link children ">Array manipulations</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/backends/martian/" class="nav-link children ">Transform requests and responses</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/backends/amqp/" class="nav-link children ">AMQP - RabbitMQ</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/backends/pubsub/" class="nav-link children ">Publisher/subscribe</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/backends/lambda/" class="nav-link children ">Lambda functions</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/backends/detailed-errors/" class="nav-link children ">Return backend errors</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-6" role="button" aria-expanded="false"
                aria-controls="menu-6" class="nav-link parent">
                Authorization
            </a>
            <div class="collapse" id="menu-6">
                <ul class="nav flex-column">
                    
                    <li class="nav-item child">
                        <a href="/docs/authorization/jwt-overview/" class="nav-link children ">JWT overview</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/authorization/jwt-validation/" class="nav-link children ">JWT Validation</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/authorization/jwt-signing/" class="nav-link children ">JWT Signing</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/authorization/revoking-tokens/" class="nav-link children ">Revoking tokens</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/authorization/client-credentials/" class="nav-link children ">OAuth2 Client credentials</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-7" role="button" aria-expanded="false"
                aria-controls="menu-7" class="nav-link parent">
                Service Discovery
            </a>
            <div class="collapse" id="menu-7">
                <ul class="nav flex-column">
                    
                    <li class="nav-item child">
                        <a href="/docs/service-discovery/overview/" class="nav-link children ">Service Discovery overview</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/service-discovery/dns-srv/" class="nav-link children ">DNS SRV</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/service-discovery/etcd/" class="nav-link children ">etcd</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/service-discovery/eureka/" class="nav-link children ">Eureka</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-8" role="button" aria-expanded="false"
                aria-controls="menu-8" class="nav-link parent">
                Traffic management
            </a>
            <div class="collapse" id="menu-8">
                <ul class="nav flex-column">
                    
                    <li class="nav-item child">
                        <a href="/docs/throttling/overview/" class="nav-link children ">Rate limits and throttling</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/throttling/botdetector/" class="nav-link children ">Bot detector</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/throttling/timeouts/" class="nav-link children ">Request timeouts</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/throttling/max-idle-connections/" class="nav-link children ">Max IDLE connections</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-9" role="button" aria-expanded="false"
                aria-controls="menu-9" class="nav-link parent">
                Logging, metrics and tracing
            </a>
            <div class="collapse" id="menu-9">
                <ul class="nav flex-column">
                    
                    <li class="nav-item child">
                        <a href="/docs/logging-metrics-tracing/logging/" class="nav-link children ">Logging</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/logging-metrics-tracing/metrics/" class="nav-link children ">Metrics</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/logging-metrics-tracing/tracing/" class="nav-link children ">Tracing</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/logging-metrics-tracing/graylog-gelf/" class="nav-link children ">Graylog - GELF</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/logging-metrics-tracing/logstash/" class="nav-link children ">Logstash</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/logging-metrics-tracing/opencensus/" class="nav-link children ">Opencensus</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/logging-metrics-tracing/prometheus/" class="nav-link children ">Prometheus</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/logging-metrics-tracing/influxdb/" class="nav-link children ">InfluxDB</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/logging-metrics-tracing/zipkin/" class="nav-link children ">Zipkin</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/logging-metrics-tracing/jaeger/" class="nav-link children ">Jaeger</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/logging-metrics-tracing/xray/" class="nav-link children ">AWS X-Ray</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/logging-metrics-tracing/stackdriver/" class="nav-link children ">Google Stackdriver</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/logging-metrics-tracing/logger/" class="nav-link children ">Logger</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-10" role="button" aria-expanded="false"
                aria-controls="menu-10" class="nav-link parent">
                Cluster
            </a>
            <div class="collapse" id="menu-10">
                <ul class="nav flex-column">
                    
                    <li class="nav-item child">
                        <a href="/docs/cluster/cluster-overview/" class="nav-link children ">Cluster Overview</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/cluster/configuration/" class="nav-link children ">Setting up a cluster</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-11" role="button" aria-expanded="false"
                aria-controls="menu-11" class="nav-link parent">
                Deploying
            </a>
            <div class="collapse" id="menu-11">
                <ul class="nav flex-column">
                    
                    <li class="nav-item child">
                        <a href="/docs/deploying/best-practices/" class="nav-link children ">Best practices</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-12" role="button" aria-expanded="false"
                aria-controls="menu-12" class="nav-link parent">
                Developer Tools
            </a>
            <div class="collapse" id="menu-12">
                <ul class="nav flex-column">
                    
                    <li class="nav-item child">
                        <a href="/docs/developer/overview/" class="nav-link children ">Developer Tools</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-13" role="button" aria-expanded="false"
                aria-controls="menu-13" class="nav-link parent">
                Extending KrakenD
            </a>
            <div class="collapse" id="menu-13">
                <ul class="nav flex-column">
                    
                    <li class="nav-item child">
                        <a href="/docs/extending/the-big-picture/" class="nav-link children ">The big picture</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/extending/writing-plugins/" class="nav-link children ">Writing custom plugins</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-14" role="button" aria-expanded="false"
                aria-controls="menu-14" class="nav-link parent">
                Benchmarks
            </a>
            <div class="collapse" id="menu-14">
                <ul class="nav flex-column">
                    
                    <li class="nav-item child">
                        <a href="/docs/benchmarks/overview/" class="nav-link children ">Benchmarks Overview</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/benchmarks/api-gateway-benchmark/" class="nav-link children ">KrakenD vs others</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/benchmarks/aws/" class="nav-link children ">On Amazon Web Services</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/benchmarks/local/" class="nav-link children ">Local machine</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
                <a href="/docs/faq/" class="nav-link">Troubleshooting</a>
                
        </li>
        
        
        <li class="nav-item">
            
                <a href="http://github.com/devopsfaith/krakend-ce/issues" class="nav-link">Issues</a>
                
        </li>
        
    </ul>
</div>
<p class="text-center">
    <small>
        <a href="/docs/" rel="nofollow" class="text-muted">Recent changes</a>
    </small>
</p>
                
            </div>

            <div class="col-md-9">
                <section class="content-header">
                    
<a class="edit-page"
href="https://github.com/devopsfaith/krakend-documentation/edit/master/backends/data-manipulation.md">
    Edit this page
</a>


<h1 class="main-title">Data manipulation</h1>



                </section>
                <section class="content">
                    

<div class="row">
    <section class="col-md-12">
        
        
        <div class="TOC float-right col-md-4 bg-white ml-3 mb-3">
            <div class="shadow rounded pb-2">
                <h6 class="header rounded-top">On this page</h6>
                <nav id="TableOfContents">
  <ul>
    <li><a href="#filtering">Filtering</a>
      <ul>
        <li><a href="#blacklist">Blacklist</a></li>
        <li><a href="#whitelist">Whitelist</a></li>
        <li><a href="#whitelist-or-blacklist">Whitelist or blacklist?</a></li>
      </ul>
    </li>
    <li><a href="#grouping">Grouping</a>
      <ul>
        <li><a href="#grouping-example">Grouping example</a></li>
      </ul>
    </li>
    <li><a href="#mapping">Mapping</a>
      <ul>
        <li><a href="#mapping-example">Mapping example:</a></li>
      </ul>
    </li>
    <li><a href="#target">Target</a>
      <ul>
        <li><a href="#capturing-a-target-example">Capturing a target example</a></li>
      </ul>
    </li>
    <li><a href="#collections">Collections</a>
      <ul>
        <li><a href="#when-the-backend-response-is-inside-an-array">When the Backend response is inside an array</a></li>
        <li><a href="#when-you-need-to-manipulate-arrays">When you need to manipulate arrays</a></li>
      </ul>
    </li>
    <li><a href="#manipulations-with-lua">Manipulations with Lua</a></li>
  </ul>
</nav>
            </div>
        </div>
        

        <h2 id="filtering">Filtering</h2>
<p>When you offer a KrakenD endpoint you can decide to show only a subset of the fields coming from the backends&rsquo; response or alter the structure of the content provided. There are a number of different reasons you might want to use this functionality, but we strongly encourage you to use it to save user&rsquo;s bandwidth and increase load and render times.</p>
<p>There are two different strategies you can use to filter content:</p>
<ul>
<li><strong>Blacklist</strong></li>
<li><strong>Whitelist</strong></li>
</ul>
<h3 id="blacklist">Blacklist</h3>
<p>The blacklist filter can be read as the <em>don&rsquo;t show this</em> filter. KrakenD will remove from the response all matching fields defined in the list, and the ones that do not match will be revealed. Use the blacklist to exclude some fields in the response.</p>
<p>To blacklist a field from the response add under the desired <code>endpoint</code> configuration an <code>blacklist</code> array with all the fields you don&rsquo;t want to show. E.g.:</p>
<pre><code>&quot;blacklist&quot;: [
  &quot;token&quot;,
  &quot;CVV&quot;
]
</code></pre>
<h4 id="nested-fields-dot-operator">Nested fields (dot operator)</h4>
<p>The blacklisted fields of your choice can also be a nested field. Use a <strong>dot</strong> as the level separator. For instance the <code>a1</code> field in the following JSON response <code>{ &quot;a&quot;: { &quot;a1&quot;: 1 } }</code> can be blacklisted as <code>a.a1</code>.</p>
<p>Also worth mentioning, the operator works with <strong>objects only</strong> and not with arrays. When working with collections <code>[]</code>, see the special case <a href="/docs/backends/flatmap/">manipulating arrays</a>.</p>
<p>For instance, <code>{ &quot;a&quot;: [ { &quot;a1&quot;: 1 } ] }</code> can&rsquo;t be blacklisted as <code>a.a1</code> because <code>a1</code> is inside an array.</p>
<div class="note">
    <h4><i class="fa fa-sticky-note"></i> Working with arrays</h4>
	Blacklist and whitelist filters expect objects. When working with collections, see the <a href="/docs/backends/flatmap/">flatmap approach</a>
 </div>
<h4 id="blacklist-example">Blacklist example</h4>
<p>We will use the <a href="https://jsonplaceholder.typicode.com/">JSONPlaceholder</a> fake API so you can see live the output of the backend.</p>
<p>We want to set up a KrakenD endpoint that returns the <strong>posts for a specific user</strong>, but we&rsquo;ve seen that the <a href="https://jsonplaceholder.typicode.com/posts/1">backend response</a> contains too much data since our use case do not need the <code>body</code> and <code>userId</code> fields and we want a lighter and faster response.</p>
<p>The KrakenD endpoint to accept URLs like<code>/posts/1</code> is defined as follows:</p>
<pre><code>{
  &quot;endpoint&quot;: &quot;/posts/{user}&quot;,
  &quot;method&quot;: &quot;GET&quot;,
  &quot;backend&quot;: [
    {
      &quot;url_pattern&quot;: &quot;/posts/{user}&quot;,
      &quot;host&quot;: [
        &quot;https://jsonplaceholder.typicode.com&quot;
      ],
      &quot;blacklist&quot;: [
        &quot;body&quot;,
        &quot;userId&quot;
      ]
    }
  ]
}
</code></pre>
<p>Now, when calling the KrakenD endpoint <code>/posts/1</code> the response you would get will be as follows:</p>
<pre><code>{
  &quot;id&quot;: 1,
  &quot;title&quot;: &quot;sunt aut facere repellat provident occaecati excepturi optio reprehenderit&quot;
}
</code></pre>
<p><a href="https://jsonplaceholder.typicode.com/posts/1">Compared with the backend response</a> you&rsquo;ll see that the fields <code>body</code> and <code>userId</code> are no longer there.</p>
<h3 id="whitelist">Whitelist</h3>
<p>The blacklist filter can be read as the <em>only show this</em> filter. When you set a whitelist KrakenD will include in the endpoint response only those fields that match exactly with your choice. Use the whitelist to strictly define the fields you want to show in the response.</p>
<p>The whitelisted fields of your choice can also be nested field. Use a <strong>dot</strong> as the level separator. For instance the <code>a1</code> field in the following JSON response <code>{ &quot;a&quot;: { &quot;a1&quot;: 1 } }</code> can be whitelisted as <code>a.a1</code>.</p>
<h4 id="whitelist-example">Whitelist example</h4>
<p>We will repeat the same exercise we did in the blacklist to get the same output. We only want to get the <code>id</code> and <code>title</code> fields from the backend.</p>
<pre><code>{
  &quot;endpoint&quot;: &quot;/posts/{user}&quot;,
  &quot;method&quot;: &quot;GET&quot;,
  &quot;backend&quot;: [
    {
      &quot;url_pattern&quot;: &quot;/posts/{user}&quot;,
      &quot;host&quot;: [
        &quot;https://jsonplaceholder.typicode.com&quot;
      ],
      &quot;whitelist&quot;: [
        &quot;id&quot;,
        &quot;title&quot;
      ]
    }
  ]
}
</code></pre>
<p>Now, when calling the KrakenD endpoint <code>/posts/1</code> the response you would get will be as follows:</p>
<pre><code>{
  &quot;id&quot;: 1,
  &quot;title&quot;: &quot;sunt aut facere repellat provident occaecati excepturi optio reprehenderit&quot;
}
</code></pre>
<p>Just exactly as we did with the blacklist.</p>
<h3 id="whitelist-or-blacklist">Whitelist or blacklist?</h3>
<p>When filtering you need to choose between the blacklist and the whitelist. The two operations cannot coexist as their behaviors are contradictory. Nothing stops you to play for a while and see what happens if you mix them, but make sure it&rsquo;s only experimentation!</p>
<p>From the performance point of view, blacklist is slightly fastest than whitelist.</p>
<h2 id="grouping">Grouping</h2>
<p>KrakenD is able to group your backend responses inside different objects. In other words, when you set a <code>group</code> attribute for a backend, instead of placing all the response attributes in the root of the response, KrakenD creates a new key and places the response inside.</p>
<p>Encapsulating backend responses inside each own group is especially interesting when different backend responses can have colliding key names (e.g: all responses contain an <code>id</code> with different values).</p>
<p>When grouping different backend responses <strong>don&rsquo;t share the same group name</strong>, as the slowest backend would overwrite the response with the same group. Group names are supposed to be unique for each backend in the same endpoint but this is not enforced.</p>
<h3 id="grouping-example">Grouping example</h3>
<p>The following code is an endpoint that gets data from two different backends but one of the responses is encapsulated inside the field <code>last_post</code>.</p>
<pre><code>{
  &quot;endpoint&quot;: &quot;/users/{user}&quot;,
  &quot;method&quot;: &quot;GET&quot;,
  &quot;backend&quot;: [
    {
      &quot;url_pattern&quot;: &quot;/users/{user}&quot;,
      &quot;host&quot;: [
        &quot;https://jsonplaceholder.typicode.com&quot;
      ]
    },
    {
      &quot;url_pattern&quot;: &quot;/posts/{user}&quot;,
      &quot;host&quot;: [
        &quot;https://jsonplaceholder.typicode.com&quot;
      ],
      &quot;group&quot;: &quot;last_post&quot;
    }
  ]
}
</code></pre>
<p>This will generate responses like this one:</p>
<pre><code>{
  &quot;id&quot;: 1,
  &quot;name&quot;: &quot;Leanne Graham&quot;,
  &quot;username&quot;: &quot;Bret&quot;,
  &quot;email&quot;: &quot;Sincere@april.biz&quot;,
  &quot;address&quot;: {
    &quot;street&quot;: &quot;Kulas Light&quot;,
    &quot;suite&quot;: &quot;Apt. 556&quot;,
    &quot;city&quot;: &quot;Gwenborough&quot;,
    &quot;zipcode&quot;: &quot;92998-3874&quot;,
    &quot;geo&quot;: {
      &quot;lat&quot;: &quot;-37.3159&quot;,
      &quot;lng&quot;: &quot;81.1496&quot;
    }
  },
  &quot;phone&quot;: &quot;1-770-736-8031 x56442&quot;,
  &quot;website&quot;: &quot;hildegard.org&quot;,
  &quot;company&quot;: {
    &quot;name&quot;: &quot;Romaguera-Crona&quot;,
    &quot;catchPhrase&quot;: &quot;Multi-layered client-server neural-net&quot;,
    &quot;bs&quot;: &quot;harness real-time e-markets&quot;
  },
  &quot;last_post&quot;: {
    &quot;id&quot;: 1,
    &quot;userId&quot;: 1,
    &quot;title&quot;: &quot;sunt aut facere repellat provident occaecati excepturi optio reprehenderit&quot;,
    &quot;body&quot;: &quot;quia et suscipit\nsuscipit recusandae consequuntur expedita et cum\nreprehenderit molestiae ut ut quas totam\nnostrum rerum est autem sunt rem eveniet architecto&quot;
  }
}
</code></pre>
<h2 id="mapping">Mapping</h2>
<p>Mapping, or also known as <strong>renaming</strong>, let you change the name of the fields of the generated responses, so your composed response would be as close to your use case as possible without changing a line on any backend.</p>
<p>In the <code>mapping</code> section map the original field name with the desired name.</p>
<h3 id="mapping-example">Mapping example:</h3>
<p>Instead of showing the <code>email</code> field we want to name it <code>personal_email</code>:</p>
<pre><code>{
  &quot;endpoint&quot;: &quot;/users/{user}&quot;,
  &quot;method&quot;: &quot;GET&quot;,
  &quot;backend&quot;: [
    {
      &quot;url_pattern&quot;: &quot;/users/{user}&quot;,
      &quot;host&quot;: [
        &quot;https://jsonplaceholder.typicode.com&quot;
      ],
      &quot;mapping&quot;: {
        &quot;email&quot;: &quot;personal_email&quot;
      }
    }
  ]
}
</code></pre>
<p>Will generate responses like this one:</p>
<pre><code>{
  &quot;id&quot;: 1,
  &quot;name&quot;: &quot;Leanne Graham&quot;,
  &quot;username&quot;: &quot;Bret&quot;,
  &quot;personal_email&quot;: &quot;Sincere@april.biz&quot;,
  &quot;address&quot;: {
    &quot;street&quot;: &quot;Kulas Light&quot;,
    &quot;suite&quot;: &quot;Apt. 556&quot;,
    &quot;city&quot;: &quot;Gwenborough&quot;,
    &quot;zipcode&quot;: &quot;92998-3874&quot;,
    &quot;geo&quot;: {
      &quot;lat&quot;: &quot;-37.3159&quot;,
      &quot;lng&quot;: &quot;81.1496&quot;
    }
  },
  &quot;phone&quot;: &quot;1-770-736-8031 x56442&quot;,
  &quot;website&quot;: &quot;hildegard.org&quot;,
  &quot;company&quot;: {
    &quot;name&quot;: &quot;Romaguera-Crona&quot;,
    &quot;catchPhrase&quot;: &quot;Multi-layered client-server neural-net&quot;,
    &quot;bs&quot;: &quot;harness real-time e-markets&quot;
  }
}
</code></pre>
<h2 id="target">Target</h2>
<p>It is frequent in many API implementations that the desired data is always encapsulated inside a generic field like <code>data</code> or <code>content</code> and you don&rsquo;t want to have this level included in your responses.</p>
<p>Use capturing when you want to capture the content inside these generic containers and extract it to the root as it never existed and when you want to work with other manipulation options. Capture takes place before other options like whitelist or mapping.</p>
<p>The capturing option uses the attribute <code>target</code> in the configuration file.</p>
<h3 id="capturing-a-target-example">Capturing a target example</h3>
<p>Given a backend endpoint with this kind of responses containing a level <code>data</code>:</p>
<pre><code>{
  &quot;apiVersion&quot;:&quot;2.0&quot;,
  &quot;data&quot;: {
    &quot;updated&quot;:&quot;2010-01-07T19:58:42.949Z&quot;,
    &quot;totalItems&quot;:800,
    &quot;startIndex&quot;:1,
    &quot;itemsPerPage&quot;:1,
    &quot;items&quot;:[]
  }
}
</code></pre>
<p>and with this KrakenD configuration</p>
<pre><code>{
  &quot;endpoint&quot;: &quot;/foo&quot;,
  &quot;method&quot;: &quot;GET&quot;,
  &quot;backend&quot;: [
    {
      &quot;url_pattern&quot;: &quot;/bar&quot;,
      &quot;target&quot;: &quot;data&quot;
    }
  ]
}
</code></pre>
<p>the gateway will generate responses like this one:</p>
<pre><code>{
    &quot;updated&quot;:&quot;2010-01-07T19:58:42.949Z&quot;,
    &quot;totalItems&quot;:800,
    &quot;startIndex&quot;:1,
    &quot;itemsPerPage&quot;:1,
    &quot;items&quot;:[]
}
</code></pre>
<h2 id="collections">Collections</h2>
<p>Working with collections (or arrays) is a special manipulation case. There are two different scenarios regarding collections:</p>
<ul>
<li>When the whole backend response is inside an array instead of an object</li>
<li>When you want to manipulate collections (e.g.: a path like <code>data.item[N].property</code>)</li>
</ul>
<h3 id="when-the-backend-response-is-inside-an-array">When the Backend response is inside an array</h3>
<p>KrakenD expects all backends to return an object as the response. For instance, a JSON response containing an object comes encapsulated in curly braces <code>{}</code>. E.g.:</p>
<pre><code>{ &quot;a&quot;: true, &quot;b&quot;: false }
</code></pre><p>When your API does not return an object but a collection (<code>[]</code> or array) you need to declare it explicitly with <code>&quot;is_collection&quot;: true</code> so that KrakenD can convert it to an object for further manipulation. An example of a JSON collection response is:</p>
<pre><code>[    {&quot;a&quot;: true },    {&quot;b&quot;: false} ]
</code></pre><p>In such cases, add inside the <code>backend</code> key the property <code>&quot;is_collection&quot;: true</code> so KrakenD can convert this collection to an object.</p>
<p>By default, KrakenD adds the key <code>collection</code> in the response, e.g.:</p>
<pre><code>{
	&quot;collection&quot;: [
		{&quot;a&quot;: true },
		{&quot;b&quot;: false}
	]
}
</code></pre><p>You can rename the default key name <code>collection</code> to something else using the <code>mapping</code> attribute (docs above, example below).</p>
<p>The following is a real example based on a <a href="http://jsonplaceholder.typicode.com/posts">collection response</a>, copy and paste to test in your environment:</p>
<pre><code>&quot;endpoints&quot;: [
    {
      &quot;endpoint&quot;: &quot;/posts&quot;,
      &quot;backend&quot;: [
        {
          &quot;url_pattern&quot;: &quot;/posts&quot;,
          &quot;host&quot;: [&quot;http://jsonplaceholder.typicode.com&quot;],
          &quot;sd&quot;: &quot;static&quot;,
          &quot;is_collection&quot;: true,
          &quot;mapping&quot;: {
            &quot;collection&quot;: &quot;myposts&quot;
          }
        }
      ]
    }
]
</code></pre><p>The response will look like this:</p>
<pre><code>{
  &quot;myposts&quot;: [
    {
      ...
    },
    {
      ...
    }
}
</code></pre><h3 id="when-you-need-to-manipulate-arrays">When you need to manipulate arrays</h3>
<p>All the data manipulation operations (such as whitelist, blacklist, etc) expect to find objects in the response. When an object is nested inside another object you can filter directly, but when there are arrays in the equation KrakenD needs to flatten the structure.</p>
<p>See <a href="/docs/backends/flatmap">flatmap documentation</a></p>
<h2 id="manipulations-with-lua">Manipulations with Lua</h2>
<p>Backends response can be transformed using Lua scripting.</p>
<p>See <a href="/docs/endpoints/lua/">Lua scripts</a> documentation</p>

    </section>
</div>

                </section>
            </div>
        </div>
    </div>
    <div class="row action-bar">
	<div class="container">
		<div class="row align-items-center">
			<div class="col-12 col-md-8">
					<h6>Unresolved issues?</h6>
					<p class="text-lead">The documentation is only a piece of the help you can get! Whether you are looking for Open Source or Enterprise support, see more support channels that can help you.</p>
			</div>
			<div class="col-12 col-md-4">
					<a class="btn btn-secondary support-button float-right" href="/support/">See all support channels</a>
			</div>
		</div>
	</div>
</div>
    <footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-5">
                <img src="/images/logo-white.png" class="pb-2" width="80%" >
                <p class="lead">The <strong>Ultra-High performance</strong> Open Source API Gateway with middlewares</p>
                <span>KrakenD helps application developers release features quickly by eliminating all the complexities of SOA architectures while offering a unique performance.</span>
                <div class="social">
                    <a href="https://www.facebook.com/apigateway" target="_blank"  title="Facebook">
                        <i class="fab fa-facebook-official" aria-hidden="true"></i><span class="sr-only">Facebook</span>
                    </a>
                    <a href="https://twitter.com/devopsfaith" target="_blank" class="social-btn-twitter" title="Twitter">
                        <i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Twitter</span>
                    </a>
                    <a href="https://github.com/devopsfaith" target="_blank" class="social-btn-github" title="GitHub">
                        <i class="fab fa-github" aria-hidden="true"></i><span class="sr-only">GitHub</span>
                    </a>
                    <a href="mailto:support@devops.faith" target="_blank" title="Send us an email">
                        <i class="fa fa-envelope" aria-hidden="true"></i><span class="sr-only">Mail</span>
                    </a>
                </div>

            </div>

                <div class="col-md-2 offset-md-1">
                    <h6>by Devops Faith</h6>
                    <ul class="list-unstyled">
                        
                        <li><a href="http://devops.faith">Devops Faith</a></li>
                        <li><a href="https://www.krakend.io/blog/">Blog</a></li>
                        <li><a href="https://medium.com/devops-faith">Medium</a></li>
                        <li><a href="mailto:support@devops.faith">Contact Us</a></li>
                    </ul>
                    <h6>More products</h6>
                    <ul class="list-unstyled">
                        <li><a href="http://api2html.com">API2HTML</a></li>
                    </ul>

                </div>
                <div class="col-md-2">
                    <h6>KrakenD</h6>
                    <ul class="list-unstyled">
                        <li><a href="https://www.krakend.io/features/">Features</a></li>
                        <li><a href="https://www.krakend.io/docs/benchmarks/overview/">Benchmarks</a></li>
                        <li><a href="https://www.krakend.io/download/">Download</a></li>
                        <li><a href="https://www.krakend.io/blog/">KrakenD Blog</a></li>
                        <li><a href="https://www.krakend.io/team/">Team</a></li>
                        <li><a href="https://www.krakend.io/case-study/">Case studies</a></li>


                    </ul>

                </div>
                <div class="col-md-2">
                    <h6>Support</h6>
                    <ul class="list-unstyled">
                        <li><a href="https://www.krakend.io/docs/overview/introduction">Documentation</a></li>
                        <li><a href="https://github.com/devopsfaith/krakend" target="_blank">Open Source</a></li>
                        <li><a href="https://github.com/devopsfaith/krakend/issues">Report a problem</a></li>
                        <li><a href="https://www.krakend.io/support/">Support</a></li>
                        

                    </ul>
                </div>

        </div>
        <div class="row copyright">
            <div class="col-md-5 additional-links">
                <strong>Copyright &copy; 2017-2020 <a href="http://devops.faith">Devops Faith</a>.</strong> All rights reserved.
            </div>
            <div class="col-md-7 hidden-xs">
                <span class="float-right">
                    Made with <i class="fa fa-heart heart"></i> in Barcelona by <a href="https://twitter.com/devopsfaith">
                    <img height="30px" src="/images/devops-faith-logo-inverse.png" />
                </span>
                </a>
            </div>
        </div>
    </div>
</footer>

<div class="pea_cook_wrapper pea_cook_bottom" style="display:none">
    <p>We use cookies to understand how you use our site and to improve your overall experience. By continuing to use our site, you accept our Privacy Policy. <a data-toggle="modal" data-target="#cookiesConsent" style="color:#0a0a0a;"
            href="#">More information</a>
        <button class="btn btn-primary btn-sm ml-2 ACCEPT_COOKIES" href="#">Accept</button>
    </p>
</div>


<div class="modal fade" id="cookiesConsent" tabindex="-1" role="dialog" aria-labelledby="cookiesConsentLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="cookiesConsentLabel">Cookies</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>In order to give you the best experience, we use cookies and similar technologies for performance, analytics and marketing. Want to know more?</p>
                <p><a href="/privacy-policy/">Privacy Policy</a></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary ACCEPT_COOKIES" data-dismiss="modal">
                    Accept cookies</button>
            </div>
        </div>
    </div>
</div>


    
<script type="application/javascript">
var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
var doNotTrack = (dnt == "1" || dnt == "yes");
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-87994359-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



    <script src="/dist/krakend-io.js"></script>
<script async defer src="https://buttons.github.io/buttons.js"></script>
	<script>
	window.fwSettings={
	'widget_id':36000000396
	};
	!function(){if("function"!=typeof window.FreshworksWidget){var n=function(){n.q.push(arguments)};n.q=[],window.FreshworksWidget=n}}() 
</script>
    
</body>

</html>