<!DOCTYPE html>
<html lang="en-us">

<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.53" />


    <title>Response manipulation - KrakenD API Gateway</title>
    <meta itemprop="name" content="Response manipulation - KrakenD API Gateway">
    <meta name="twitter:title" content="Response manipulation - KrakenD API Gateway">
    <meta property="og:title" content="Response manipulation - KrakenD API Gateway">

    
    <meta property="description" content="Response manipulation - KrakenD API Gateway">
    <meta itemprop="description" content="Response manipulation - KrakenD API Gateway">
    <meta name="twitter:description" content="Response manipulation - KrakenD API Gateway">
    <meta property="og:description" content="Response manipulation - KrakenD API Gateway">
    

    
    <meta itemprop="image" content="https://www.krakend.io/images/logo.png">
    <meta name="twitter:image:src" content="https://www.krakend.io/images/logo.png">
    <meta property="og:image" content="https://www.krakend.io/images/logo.png" />
    

    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://www.krakend.io/docs/endpoints/response-manipulation/" />



<meta name="twitter:site" content="@devopsfaith">
<meta name="twitter:creator" content="@devopsfaith">
<meta name="twitter:card" content="summary">


<meta property="og:site_name" content="KrakenD API Gateway" />




<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">

<link rel="stylesheet" href="/dist/styles.css">


<link rel="icon" type="image/png" href="/favicon/favicon-196x196.png" sizes="196x196" />
<link rel="icon" type="image/png" href="/favicon/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/png" href="/favicon/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="/favicon/favicon-16x16.png" sizes="16x16" />
<link rel="icon" type="image/png" href="/favicon/favicon-128.png" sizes="128x128" />
</head>

<body class="krakend page-bf88228601c48188ee85f12de278806e">
    
    <div class="top-bar">
  <div class="container my-2">
    <nav class="navbar navbar-expand-lg navbar-light">
      <a class="navbar-brand" href="/" title="Home">
        <img class="mr-4" src="/images/logo.png" alt="" width="180">
      </a>
      <div class="collapse navbar-collapse" id="navbarMenu">
        <ul class="mega-dropdown navbar-nav mr-auto">
          

          <li class="nav-item">
            <a class="nav-link" href="/features/">Features</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/docs/overview/introduction/">Documentation</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/enterprise/">Enterprise</a>
          </li>
          <li class="nav-item">
              <a class="nav-link" href="/support/">Support</a>
            </li>
          <li class="nav-item">
            <a class="nav-link" href="/blog/">Blog</a>
          </li>
        </ul>
      </div>


      <div class="github d-none d-lg-block">
        <a class="nav-link github-button" href="https://github.com/devopsfaith/krakend" data-show-count="true"
          aria-label="Star devopsfaith/krakend on GitHub">Star</a>
      </div>
      <div class="download d-none d-lg-block">
          <a class="btn btn-sm" href="/download/">Downloads</a>
      </div>
      <div class="designer d-none d-lg-block">
        <a class="btn btn-sm" href="https://designer.krakend.io">Designer</a>
      </div>
      
     
      
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMenu" aria-controls="navbarMenu"
        aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
    </nav>
  </div>
</div>
    <div class="documentation mr-3">
        <div class="row">
            <div class="col-md-3">
                
                <div class="sidebar ml-3 mb-3">
    <h6 class="header">Documentation</h6>
    <ul class="nav menu">

        
        
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-0" role="button" aria-expanded="false"
                aria-controls="menu-0" class="nav-link parent">
                Getting Started
            </a>
            <div class="collapse" id="menu-0">
                <ul class="nav flex-column">
                    
                    <li class="nav-item child">
                        <a href="/docs/overview/introduction/" class="nav-link children ">Introduction</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/overview/installing/" class="nav-link children ">Installing KrakenD</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/overview/usage/" class="nav-link children ">Using KrakenD</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/overview/krakend-vs-krakend-ce/" class="nav-link children ">KrakenD vs. KrakenD-CE</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/overview/playground/" class="nav-link children ">The Playground</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-1" role="button" aria-expanded="false"
                aria-controls="menu-1" class="nav-link parent">
                Configuration file
            </a>
            <div class="collapse" id="menu-1">
                <ul class="nav flex-column">
                    
                    <li class="nav-item child">
                        <a href="/docs/configuration/overview/" class="nav-link children ">Configuration overview</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/configuration/structure/" class="nav-link children ">File structure</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/configuration/supported-formats/" class="nav-link children ">Supported file formats</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/configuration/flexible-config/" class="nav-link children ">Flexible configuration</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-2" role="button" aria-expanded="false"
                aria-controls="menu-2" class="nav-link parent">
                Command line commands
            </a>
            <div class="collapse" id="menu-2">
                <ul class="nav flex-column">
                    
                    <li class="nav-item child">
                        <a href="/docs/commands/run/" class="nav-link children ">Run</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/commands/check/" class="nav-link children ">Check</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-3" role="button" aria-expanded="false"
                aria-controls="menu-3" class="nav-link parent">
                Service settings
            </a>
            <div class="collapse" id="menu-3">
                <ul class="nav flex-column">
                    
                    <li class="nav-item child">
                        <a href="/docs/service-settings/tls/" class="nav-link children ">TLS</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-4" role="button" aria-expanded="true"
                aria-controls="menu-4" class="nav-link parent active">
                Endpoints
            </a>
            <div class="collapse show" id="menu-4">
                <ul class="nav flex-column menu-open">
                    
                    <li class="nav-item child">
                        <a href="/docs/endpoints/rate-limit/" class="nav-link children ">Rate Limits</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/endpoints/response-manipulation/" class="nav-link children active">Response manipulation</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/endpoints/parameter-forwarding/" class="nav-link children ">Parameter forwarding</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/endpoints/debug-endpoint/" class="nav-link children ">Debug endpoint</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/endpoints/security/" class="nav-link children ">Security</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/endpoints/content-types/" class="nav-link children ">Content Types</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/endpoints/no-op/" class="nav-link children ">No-op (proxy only)</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/endpoints/sequential-proxy/" class="nav-link children ">Sequential Proxy (chain reqs.)</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/endpoints/static-proxy/" class="nav-link children ">Static responses (stubs)</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/endpoints/common-expression-language-cel/" class="nav-link children ">Checking requests and responses</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-5" role="button" aria-expanded="false"
                aria-controls="menu-5" class="nav-link parent">
                Backends
            </a>
            <div class="collapse" id="menu-5">
                <ul class="nav flex-column">
                    
                    <li class="nav-item child">
                        <a href="/docs/backends/overview/" class="nav-link children ">Backends Overview</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/backends/rate-limit/" class="nav-link children ">Proxy rate limit</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/backends/circuit-breaker/" class="nav-link children ">Circuit Breaker</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/backends/concurrent-requests/" class="nav-link children ">Concurrent Requests</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/backends/supported-encodings/" class="nav-link children ">Supported encodings</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/backends/caching/" class="nav-link children ">Caching responses</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-6" role="button" aria-expanded="false"
                aria-controls="menu-6" class="nav-link parent">
                Authorization
            </a>
            <div class="collapse" id="menu-6">
                <ul class="nav flex-column">
                    
                    <li class="nav-item child">
                        <a href="/docs/authorization/jwt-overview/" class="nav-link children ">JWT overview</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/authorization/jwt-validation/" class="nav-link children ">JWT Validation</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/authorization/jwt-signing/" class="nav-link children ">JWT Signing</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/authorization/revoking-tokens/" class="nav-link children ">Revoking tokens</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/authorization/client-credentials/" class="nav-link children ">OAuth2 Client credentials</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-7" role="button" aria-expanded="false"
                aria-controls="menu-7" class="nav-link parent">
                Service Discovery
            </a>
            <div class="collapse" id="menu-7">
                <ul class="nav flex-column">
                    
                    <li class="nav-item child">
                        <a href="/docs/service-discovery/overview/" class="nav-link children ">Service Discovery overview</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/service-discovery/dns-srv/" class="nav-link children ">DNS SRV</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/service-discovery/etcd/" class="nav-link children ">etcd</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/service-discovery/eureka/" class="nav-link children ">Eureka</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-8" role="button" aria-expanded="false"
                aria-controls="menu-8" class="nav-link parent">
                Throttling and limits
            </a>
            <div class="collapse" id="menu-8">
                <ul class="nav flex-column">
                    
                    <li class="nav-item child">
                        <a href="/docs/throttling/overview/" class="nav-link children ">Rate limits and throttling overview</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/throttling/timeouts/" class="nav-link children ">Timeouts</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/throttling/max-idle-connections/" class="nav-link children ">Max IDLE connections</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-9" role="button" aria-expanded="false"
                aria-controls="menu-9" class="nav-link parent">
                Logging, metrics and tracing
            </a>
            <div class="collapse" id="menu-9">
                <ul class="nav flex-column">
                    
                    <li class="nav-item child">
                        <a href="/docs/logging-metrics-tracing/logging/" class="nav-link children ">Logging</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/logging-metrics-tracing/metrics/" class="nav-link children ">Metrics</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-10" role="button" aria-expanded="false"
                aria-controls="menu-10" class="nav-link parent">
                Cluster
            </a>
            <div class="collapse" id="menu-10">
                <ul class="nav flex-column">
                    
                    <li class="nav-item child">
                        <a href="/docs/cluster/cluster-overview/" class="nav-link children ">Cluster Overview</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/cluster/configuration/" class="nav-link children ">Setting up a cluster</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-11" role="button" aria-expanded="false"
                aria-controls="menu-11" class="nav-link parent">
                Deploying
            </a>
            <div class="collapse" id="menu-11">
                <ul class="nav flex-column">
                    
                    <li class="nav-item child">
                        <a href="/docs/deploying/best-practices/" class="nav-link children ">Best practices</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-12" role="button" aria-expanded="false"
                aria-controls="menu-12" class="nav-link parent">
                Developer Tools
            </a>
            <div class="collapse" id="menu-12">
                <ul class="nav flex-column">
                    
                    <li class="nav-item child">
                        <a href="/docs/developer/overview/" class="nav-link children ">Developer Tools</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-13" role="button" aria-expanded="false"
                aria-controls="menu-13" class="nav-link parent">
                Extending KrakenD
            </a>
            <div class="collapse" id="menu-13">
                <ul class="nav flex-column">
                    
                    <li class="nav-item child">
                        <a href="/docs/extending/the-big-picture/" class="nav-link children ">The big picture</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
            <a data-toggle="collapse" href="#menu-14" role="button" aria-expanded="false"
                aria-controls="menu-14" class="nav-link parent">
                Benchmarks
            </a>
            <div class="collapse" id="menu-14">
                <ul class="nav flex-column">
                    
                    <li class="nav-item child">
                        <a href="/docs/benchmarks/overview/" class="nav-link children ">Benchmarks Overview</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/benchmarks/api-gateway-benchmark/" class="nav-link children ">KrakenD vs others</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/benchmarks/aws/" class="nav-link children ">On Amazon Web Services</a>
                    </li>
                    
                    <li class="nav-item child">
                        <a href="/docs/benchmarks/local/" class="nav-link children ">Local machine</a>
                    </li>
                    
                </ul>
            </div>
            
        </li>
        
        
        <li class="nav-item">
            
                <a href="/docs/faq/" class="nav-link">Troubleshooting</a>
                
        </li>
        
        
        <li class="nav-item">
            
                <a href="http://github.com/devopsfaith/krakend-ce/issues" class="nav-link">Issues</a>
                
        </li>
        
    </ul>
</div>
<p class="text-center">
    <small>
        <a href="/docs/" rel="nofollow" class="text-muted">Recent changes</a>
    </small>
</p>
                
            </div>

            <div class="col-md-9">
                <div class="px-3">
                    <section class="content-header">
                        
<a class="edit-page"
href="https://github.com/devopsfaith/krakend-documentation/edit/master/endpoints/response-manipulation.md">
    Edit this page
</a>
<h1 class="main-title">Response manipulation</h1>


                    </section>
                    <section class="content">
                        

<div class="row">
    <section class="col-md-12">
        
        
        <div class="TOC float-right col-md-4 bg-white ml-3 mb-3">
            <div class="shadow rounded pb-2">
                <h6 class="header rounded-top">On this page</h6>
                <nav id="TableOfContents">
<ul>
<li><a href="#merging">Merging</a>
<ul>
<li><a href="#merging-timeouts">Merging timeouts</a>
<ul>
<li><a href="#what-happens-when-the-timeout-is-triggered-or-some-backend-failed">What happens when the timeout is triggered or some backend failed?</a></li>
</ul></li>
<li><a href="#merge-example">Merge example</a></li>
</ul></li>
<li><a href="#filtering">Filtering</a>
<ul>
<li><a href="#blacklisting-fields-don-t-show">Blacklisting fields (don&rsquo;t show)</a>
<ul>
<li><a href="#blacklist-example">Blacklist example</a></li>
</ul></li>
<li><a href="#whitelisting-fields-only-show">Whitelisting fields (only show)</a></li>
<li><a href="#whitelist-or-blacklist">Whitelist or blacklist</a></li>
</ul></li>
<li><a href="#grouping">Grouping</a>
<ul>
<li><a href="#grouping-example">Grouping example</a></li>
</ul></li>
<li><a href="#mapping-renaming">Mapping (renaming)</a>
<ul>
<li><a href="#mapping-example">Mapping example:</a></li>
</ul></li>
<li><a href="#capturing">Capturing</a>
<ul>
<li><a href="#capturing-example">Capturing example</a></li>
</ul></li>
<li><a href="#collections-or-arrays">Collections or Arrays</a></li>
</ul>
</nav>
            </div>
        </div>
        

        

<p>KrakenD allows you to perform several manipulations of the responses out of the box, just by adding them to the configuration file. You can also add your own or 3rd parties middlewares to extend this behavior.</p>

<p>KrakenD manipulations are measured in <code>nanoseconds</code>, you can find the benchmark for every response manipulation in the <a href="https://github.com/devopsfaith/krakend/blob/master/docs/BENCHMARKS.md#response-manipulation">benchmarks</a></p>

<p>The following manipulations are available by default:</p>

<h1 id="merging">Merging</h1>

<p>When you create KrakenD endpoints, if a specific endpoint feeds from 2 or more backend sources (APIs), they will be automatically merged in a single response to the client. For instance, imagine you have 3 different API services exposing the resources <code>/a</code>,<code>/b</code>, and <code>/c</code> and you want to expose them all together in the KrakenD endpoint <code>/abc</code>. This is what you would get:</p>

<p><img class="img-fluid" src="/images/documentation/krakend-merge.png" /></p>

<p>The merge operation is implemented in a way where user experience and responsiveness goes first. It does its <em>best effort</em> to get all the required parts from the involved backends and returning the composed object as soon as possible.</p>

<p>By simply adding several backends into an endpoint, you get the merge operation automatically.</p>

<p>The configuration for the image above could be like this:</p>

<pre><code>&quot;endpoints&quot;: [
    {
      &quot;endpoint&quot;: &quot;/abc&quot;,
      &quot;timeout&quot;: &quot;800ms&quot;,
      &quot;method&quot;: &quot;GET&quot;,
      &quot;backend&quot;: [
        {
          &quot;url_pattern&quot;: &quot;/a&quot;,
          &quot;encoding&quot;: &quot;json&quot;,
          &quot;host&quot;: [
            &quot;http://service-a.company.com&quot;
          ]
        },
        {
          &quot;url_pattern&quot;: &quot;/b&quot;,
          &quot;encoding&quot;: &quot;xml&quot;,
          &quot;host&quot;: [
            &quot;http://service-b.company.com&quot;
          ]
        },
        {
          &quot;url_pattern&quot;: &quot;/c&quot;,
          &quot;encoding&quot;: &quot;json&quot;,
          &quot;host&quot;: [
            &quot;http://service-c.company.com&quot;
          ]
        }
      ]
    }
</code></pre>

<h2 id="merging-timeouts">Merging timeouts</h2>

<p>Keep in mind that in order to avoid any degraded user experience, KrakenD won&rsquo;t be stuck forever until all the backends decide to respond. In a gateway <strong>failing fast is better than succeeding slowly</strong> and KrakenD will make sure this happens as it will <strong>apply the timeout policy</strong>. This will put your users safe during high load peaks, network errors, or any other problems that stress your backends.</p>

<p>The <code>timeout</code> value can be introduced inside each endpoint or globally placing <code>timeout</code> in the root of the configuration file. The most specific definition always overwrites the generic one.</p>

<h3 id="what-happens-when-the-timeout-is-triggered-or-some-backend-failed">What happens when the timeout is triggered or some backend failed?</h3>

<p>If KrakenD is waiting for the backends to respond and the timeout is reached, the response will be incomplete and missing any data that couldn&rsquo;t be fetched before the timeout happened. On the other hand, all the parts that could effectively be retrieved before the timeout happened they will do appear in the response.</p>

<p>If the response has missing parts, the cache header won&rsquo;t exist, as we don&rsquo;t want clients to cache incomplete responses.</p>

<p>At all times, the <code>x-krakend-completed</code> header returned by KrakenD contains a boolean telling you if all backends returned its content (<code>x-krakend-completed: true</code>) or a partial response (<code>x-krakend-completed: false</code>).</p>

<h2 id="merge-example">Merge example</h2>

<p>Imagine an endpoint with the following configuration:</p>

<pre><code>...
&quot;endpoints&quot;: [
    {
      &quot;endpoint&quot;: &quot;/users/{user}&quot;,
      &quot;method&quot;: &quot;GET&quot;,
      &quot;timeout&quot;: &quot;800ms&quot;
      &quot;backend&quot;: [
        {
          &quot;url_pattern&quot;: &quot;/users/{user}&quot;,
          &quot;host&quot;: [
            &quot;https://jsonplaceholder.typicode.com&quot;
          ]
        },
        {
          &quot;url_pattern&quot;: &quot;/posts/{user}&quot;,
          &quot;host&quot;: [
            &quot;https://jsonplaceholder.typicode.com&quot;
          ]
        }
      ]
    }
</code></pre>

<p>When a user calls the endpoint <code>/users/1</code>, KrakenD will send two requests and, in the happy scenario, it will receive these responses:</p>

<pre><code>{
  &quot;id&quot;: 1,
  &quot;name&quot;: &quot;Leanne Graham&quot;,
  &quot;username&quot;: &quot;Bret&quot;,
  &quot;email&quot;: &quot;Sincere@april.biz&quot;,
  &quot;address&quot;: {
    &quot;street&quot;: &quot;Kulas Light&quot;,
    &quot;suite&quot;: &quot;Apt. 556&quot;,
    &quot;city&quot;: &quot;Gwenborough&quot;,
    &quot;zipcode&quot;: &quot;92998-3874&quot;,
    &quot;geo&quot;: {
      &quot;lat&quot;: &quot;-37.3159&quot;,
      &quot;lng&quot;: &quot;81.1496&quot;
    }
  },
  &quot;phone&quot;: &quot;1-770-736-8031 x56442&quot;,
  &quot;website&quot;: &quot;hildegard.org&quot;,
  &quot;company&quot;: {
    &quot;name&quot;: &quot;Romaguera-Crona&quot;,
    &quot;catchPhrase&quot;: &quot;Multi-layered client-server neural-net&quot;,
    &quot;bs&quot;: &quot;harness real-time e-markets&quot;
  }
}
</code></pre>

<p>and</p>

<pre><code>{
  &quot;userId&quot;: 1,
  &quot;id&quot;: 1,
  &quot;title&quot;: &quot;sunt aut facere repellat provident occaecati excepturi optio reprehenderit&quot;,
  &quot;body&quot;: &quot;quia et suscipit\nsuscipit recusandae consequuntur expedita et cum\nreprehenderit molestiae ut ut quas totam\nnostrum rerum est autem sunt rem eveniet architecto&quot;
}
</code></pre>

<p>With these &lsquo;partial responses&rsquo; and the given configuration, KrakenD will return the following response:</p>

<pre><code>{
  &quot;id&quot;: 1,
  &quot;name&quot;: &quot;Leanne Graham&quot;,
  &quot;username&quot;: &quot;Bret&quot;,
  &quot;email&quot;: &quot;Sincere@april.biz&quot;,
  &quot;address&quot;: {
    &quot;street&quot;: &quot;Kulas Light&quot;,
    &quot;suite&quot;: &quot;Apt. 556&quot;,
    &quot;city&quot;: &quot;Gwenborough&quot;,
    &quot;zipcode&quot;: &quot;92998-3874&quot;,
    &quot;geo&quot;: {
      &quot;lat&quot;: &quot;-37.3159&quot;,
      &quot;lng&quot;: &quot;81.1496&quot;
    }
  },
  &quot;phone&quot;: &quot;1-770-736-8031 x56442&quot;,
  &quot;website&quot;: &quot;hildegard.org&quot;,
  &quot;company&quot;: {
    &quot;name&quot;: &quot;Romaguera-Crona&quot;,
    &quot;catchPhrase&quot;: &quot;Multi-layered client-server neural-net&quot;,
    &quot;bs&quot;: &quot;harness real-time e-markets&quot;
  },
  &quot;userId&quot;: 1,
  &quot;title&quot;: &quot;sunt aut facere repellat provident occaecati excepturi optio reprehenderit&quot;,
  &quot;body&quot;: &quot;quia et suscipit\nsuscipit recusandae consequuntur expedita et cum\nreprehenderit molestiae ut ut quas totam\nnostrum rerum est autem sunt rem eveniet architecto&quot;
}
</code></pre>

<h1 id="filtering">Filtering</h1>

<p>When you create a KrakenD endpoint you can decide to show only a subset of the fields coming from the response of your backends. There are a number of different reasons you might want to use this functionality, but we strongly encourage you to use it to save user&rsquo;s bandwidth and increase load and render times.</p>

<p>There are two different strategies you can use to filter content:</p>

<ul>
<li>Blacklist</li>
<li>Whitelist</li>
</ul>

<h2 id="blacklisting-fields-don-t-show">Blacklisting fields (don&rsquo;t show)</h2>

<p>The blacklist filter can be read as the <em>don&rsquo;t show this</em> filter. KrakenD will remove from the response all matching fields defined in the list, and the ones that do not match will be revealed. Use the blacklist to exclude some fields in the response.</p>

<p>The blacklisted fields of your choice can also be nested field. Use a <strong>dot</strong> as the level separator. For instance the <code>a1</code> field in the following JSON response <code>{ &quot;a&quot;: { &quot;a1&quot;: 1 } }</code> can be blacklisted as <code>a.a1</code>.</p>

<h3 id="blacklist-example">Blacklist example</h3>

<p>We will use the <a href="https://jsonplaceholder.typicode.com/">JSONPlaceholder</a> fake API so you can see live the output of the backend.</p>

<p>We want to set up a KrakenD endpoint that returns the <strong>posts for a specific user</strong>, but we&rsquo;ve seen that the <a href="https://jsonplaceholder.typicode.com/posts/1">backend response</a> contains too much data since our use case do not need the <code>body</code> and <code>userId</code> fields and we want a lighter and faster response.</p>

<p>The KrakenD endpoint to accept URLs like<code>/posts/1</code> is defined as follows:</p>

<pre><code>{
  &quot;endpoint&quot;: &quot;/posts/{user}&quot;,
  &quot;method&quot;: &quot;GET&quot;,
  &quot;backend&quot;: [
    {
      &quot;url_pattern&quot;: &quot;/posts/{user}&quot;,
      &quot;host&quot;: [
        &quot;https://jsonplaceholder.typicode.com&quot;
      ],
      &quot;blacklist&quot;: [
        &quot;body&quot;,
        &quot;userId&quot;
      ]
    }
  ]
}
</code></pre>

<p>Now, when calling the KrakenD endpoint <code>/posts/1</code> the response you would get will be as follows:</p>

<pre><code>{
  &quot;id&quot;: 1,
  &quot;title&quot;: &quot;sunt aut facere repellat provident occaecati excepturi optio reprehenderit&quot;
}
</code></pre>

<p><a href="https://jsonplaceholder.typicode.com/posts/1">Compared with the backend response</a> you&rsquo;ll see that the fields <code>body</code> and <code>userId</code> are no longer there.</p>

<h2 id="whitelisting-fields-only-show">Whitelisting fields (only show)</h2>

<p>The blacklist filter can be read as the <em>only show this</em> filter. When you set a whitelist KrakenD will include in the endpoint response only those fields that match exactly with your choice. Use the whitelist to strictly define the fields you want to show in the response.</p>

<p>The whitelisted fields of your choice can also be nested field. Use a <strong>dot</strong> as the level separator. For instance the <code>a1</code> field in the following JSON response <code>{ &quot;a&quot;: { &quot;a1&quot;: 1 } }</code> can be whitelisted as <code>a.a1</code>.</p>

<p>###Â Whitelist example
We will repeat the same exercise we did in the blacklist to get the same output. We only want to get the <code>id</code> and <code>title</code> fields from the backend.</p>

<pre><code>{
  &quot;endpoint&quot;: &quot;/posts/{user}&quot;,
  &quot;method&quot;: &quot;GET&quot;,
  &quot;backend&quot;: [
    {
      &quot;url_pattern&quot;: &quot;/posts/{user}&quot;,
      &quot;host&quot;: [
        &quot;https://jsonplaceholder.typicode.com&quot;
      ],
      &quot;whitelist&quot;: [
        &quot;id&quot;,
        &quot;title&quot;
      ]
    }
  ]
}
</code></pre>

<p>Now, when calling the KrakenD endpoint <code>/posts/1</code> the response you would get will be as follows:</p>

<pre><code>{
  &quot;id&quot;: 1,
  &quot;title&quot;: &quot;sunt aut facere repellat provident occaecati excepturi optio reprehenderit&quot;
}
</code></pre>

<p>Just exactly as we did with the blacklist.</p>

<h2 id="whitelist-or-blacklist">Whitelist or blacklist</h2>

<p>When filtering you need to choose the blacklist or the whitelist, as the behaviors are contradictory and can&rsquo;t coexist. Nothing stops you to play for a while and see what happens if you mix them, but you&rsquo;ve been warned!</p>

<h1 id="grouping">Grouping</h1>

<p>KrakenD is able to group partial responses from backends under a user-defined field. In other words, when you set the <code>group</code> attribute for a backend, instead of placing all the response attributes in the root, KrakenD will create a new key and place the response inside.</p>

<p>Grouping is useful to encapsulate every backend call under different keys, especially when different backend responses can have colliding key names (e.g: all responses contain an <code>id</code> with different values).</p>

<h2 id="grouping-example">Grouping example</h2>

<p>The following code is an endpoint that gets data from two different backends but one of the responses is encapsulated inside the field <code>last_post</code>.</p>

<pre><code>{
  &quot;endpoint&quot;: &quot;/users/{user}&quot;,
  &quot;method&quot;: &quot;GET&quot;,
  &quot;backend&quot;: [
    {
      &quot;url_pattern&quot;: &quot;/users/{user}&quot;,
      &quot;host&quot;: [
        &quot;https://jsonplaceholder.typicode.com&quot;
      ]
    },
    {
      &quot;url_pattern&quot;: &quot;/posts/{user}&quot;,
      &quot;host&quot;: [
        &quot;https://jsonplaceholder.typicode.com&quot;
      ],
      &quot;group&quot;: &quot;last_post&quot;
    }
  ]
}
</code></pre>

<p>This will generate responses like this one:</p>

<pre><code>{
  &quot;id&quot;: 1,
  &quot;name&quot;: &quot;Leanne Graham&quot;,
  &quot;username&quot;: &quot;Bret&quot;,
  &quot;email&quot;: &quot;Sincere@april.biz&quot;,
  &quot;address&quot;: {
    &quot;street&quot;: &quot;Kulas Light&quot;,
    &quot;suite&quot;: &quot;Apt. 556&quot;,
    &quot;city&quot;: &quot;Gwenborough&quot;,
    &quot;zipcode&quot;: &quot;92998-3874&quot;,
    &quot;geo&quot;: {
      &quot;lat&quot;: &quot;-37.3159&quot;,
      &quot;lng&quot;: &quot;81.1496&quot;
    }
  },
  &quot;phone&quot;: &quot;1-770-736-8031 x56442&quot;,
  &quot;website&quot;: &quot;hildegard.org&quot;,
  &quot;company&quot;: {
    &quot;name&quot;: &quot;Romaguera-Crona&quot;,
    &quot;catchPhrase&quot;: &quot;Multi-layered client-server neural-net&quot;,
    &quot;bs&quot;: &quot;harness real-time e-markets&quot;
  },
  &quot;last_post&quot;: {
    &quot;id&quot;: 1,
    &quot;userId&quot;: 1,
    &quot;title&quot;: &quot;sunt aut facere repellat provident occaecati excepturi optio reprehenderit&quot;,
    &quot;body&quot;: &quot;quia et suscipit\nsuscipit recusandae consequuntur expedita et cum\nreprehenderit molestiae ut ut quas totam\nnostrum rerum est autem sunt rem eveniet architecto&quot;
  }
}
</code></pre>

<h1 id="mapping-renaming">Mapping (renaming)</h1>

<p>KrakenD is also able to manipulate the name of the fields of the generated responses, so your composed response would be as close to your use case as possible without changing a line on any backend.</p>

<p>In the <code>mapping</code> section map the original field name with the desired name.</p>

<h2 id="mapping-example">Mapping example:</h2>

<p>Instead of showing the <code>email</code> field we want to name it <code>personal_email</code>:</p>

<pre><code>{
  &quot;endpoint&quot;: &quot;/users/{user}&quot;,
  &quot;method&quot;: &quot;GET&quot;,
  &quot;backend&quot;: [
    {
      &quot;url_pattern&quot;: &quot;/users/{user}&quot;,
      &quot;host&quot;: [
        &quot;https://jsonplaceholder.typicode.com&quot;
      ],
      &quot;mapping&quot;: {
        &quot;email&quot;: &quot;personal_email&quot;
      }
    }
  ]
}
</code></pre>

<p>Will generate responses like this one:</p>

<pre><code>{
  &quot;id&quot;: 1,
  &quot;name&quot;: &quot;Leanne Graham&quot;,
  &quot;username&quot;: &quot;Bret&quot;,
  &quot;personal_email&quot;: &quot;Sincere@april.biz&quot;,
  &quot;address&quot;: {
    &quot;street&quot;: &quot;Kulas Light&quot;,
    &quot;suite&quot;: &quot;Apt. 556&quot;,
    &quot;city&quot;: &quot;Gwenborough&quot;,
    &quot;zipcode&quot;: &quot;92998-3874&quot;,
    &quot;geo&quot;: {
      &quot;lat&quot;: &quot;-37.3159&quot;,
      &quot;lng&quot;: &quot;81.1496&quot;
    }
  },
  &quot;phone&quot;: &quot;1-770-736-8031 x56442&quot;,
  &quot;website&quot;: &quot;hildegard.org&quot;,
  &quot;company&quot;: {
    &quot;name&quot;: &quot;Romaguera-Crona&quot;,
    &quot;catchPhrase&quot;: &quot;Multi-layered client-server neural-net&quot;,
    &quot;bs&quot;: &quot;harness real-time e-markets&quot;
  }
}
</code></pre>

<h1 id="capturing">Capturing</h1>

<p>It is frequent in many API implementations that the desired data is always encapsulated inside a generic field like <code>data</code> or <code>content</code> and you don&rsquo;t want to have this level in your responses.</p>

<p>Use capturing when you want to capture the content inside these generic containers and extract it to the root as it never existed and when you want to work with other manipulation options. Capture takes place before other options like whitelist or mapping.</p>

<p>The capturing option uses the attribute <code>target</code> in the configuration file.</p>

<h2 id="capturing-example">Capturing example</h2>

<p>Given a backend endpoint with this kind of responses containing a level <code>data</code>:</p>

<pre><code>{
  &quot;apiVersion&quot;:&quot;2.0&quot;,
  &quot;data&quot;: {
    &quot;updated&quot;:&quot;2010-01-07T19:58:42.949Z&quot;,
    &quot;totalItems&quot;:800,
    &quot;startIndex&quot;:1,
    &quot;itemsPerPage&quot;:1,
    &quot;items&quot;:[]
  }
}
</code></pre>

<p>and with this KrakenD configuration</p>

<pre><code>{
  &quot;endpoint&quot;: &quot;/foo&quot;,
  &quot;method&quot;: &quot;GET&quot;,
  &quot;backend&quot;: [
    {
      &quot;url_pattern&quot;: &quot;/bar&quot;,
      &quot;target&quot;: &quot;data&quot;
    }
  ]
}
</code></pre>

<p>the gateway will generate responses like this one:</p>

<pre><code>{
    &quot;updated&quot;:&quot;2010-01-07T19:58:42.949Z&quot;,
    &quot;totalItems&quot;:800,
    &quot;startIndex&quot;:1,
    &quot;itemsPerPage&quot;:1,
    &quot;items&quot;:[]
}
</code></pre>

<h1 id="collections-or-arrays">Collections or Arrays</h1>

<p>KrakenD expects that all backends return an object. For instance, a JSON response needs to be encapsulated between curly braces <code>{}</code>. E.g.:</p>

<pre><code>{
	&quot;a&quot;: true,
	&quot;b&quot;: false
}
</code></pre>

<p>When your API returns a collection (<code>[]</code> or array) instead of an object you need to tell this to KrakenD so its content can be converted to an object. Example of collection:</p>

<pre><code>[
	{&quot;a&quot;: true },
	{&quot;b&quot;: false}
]
</code></pre>

<p>In these cases, add inside the <code>backend</code> key the property <code>&quot;is_collection&quot;: true</code> so KrakenD can convert this collection to an object. By default, the key <code>collection</code> will be added, e.g.:</p>

<pre><code>{
	&quot;collection&quot;: [
		{&quot;a&quot;: true },
		{&quot;b&quot;: false}
	]
}
</code></pre>

<p>You can rename the automatically named key <code>collection</code> to something else using the <code>mapping</code> attribute (see above).</p>

<p>The following is a real example based on a <a href="http://jsonplaceholder.typicode.com/posts">collection response</a>, copy and paste to test in your environment:</p>

<pre><code>&quot;endpoints&quot;: [
    {
      &quot;endpoint&quot;: &quot;/posts&quot;,
      &quot;backend&quot;: [
        {
          &quot;url_pattern&quot;: &quot;/posts&quot;,
          &quot;host&quot;: [&quot;http://jsonplaceholder.typicode.com&quot;],
          &quot;sd&quot;: &quot;static&quot;,
          &quot;is_collection&quot;: true,
          &quot;mapping&quot;: {
            &quot;collection&quot;: &quot;myposts&quot;
          }
        }
      ]
    }
]
</code></pre>

<p>The response will look like this:</p>

<pre><code>{
  &quot;myposts&quot;: [
    {
      ...
    },
    {
      ...
    }
}
</code></pre>

<div class="alert note">
    <h4><i class="fa fa-sticky-note"></i> No manipulation on arrays</h4>
	<p>When working with backend responses that are collections be aware that
data manipulations are not available (except for the mapping/renaming of the
<code>collection</code> key)</p>

 </div>

    </section>
</div>

                    </section>
                </div>
            </div>
        </div>
    </div>
    <div class="row action-bar">
	<div class="container">
		<div class="row align-items-center">
			<div class="col-12 col-md-8">
					<h6>Unresolved issues?</h6>
					<p class="text-lead">The documentation is only a piece of the help you can get! Whether you are looking for Open Source or Enterprise support, see more support channels that can help you.</p>
			</div>
			<div class="col-12 col-md-4">
					<a class="btn btn-secondary support-button float-right" href="/support/">See all support channels</a>
			</div>
		</div>
	</div>
</div>
    <footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-5">
                <img src="/images/logo-white.png" class="pb-2" width="80%" >
                <p class="lead">The <strong>Ultra-High performance</strong> Open Source API Gateway with middlewares</p>
                <span>KrakenD helps application developers release features quickly by eliminating all the complexities of SOA architectures while offering a unique performance.</span>
                <div class="social">
                    <a href="https://www.facebook.com/apigateway" target="_blank"  title="Facebook">
                        <i class="fab fa-facebook-official" aria-hidden="true"></i><span class="sr-only">Facebook</span>
                    </a>
                    <a href="https://twitter.com/devopsfaith" target="_blank" class="social-btn-twitter" title="Twitter">
                        <i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Twitter</span>
                    </a>
                    <a href="https://github.com/devopsfaith" target="_blank" class="social-btn-github" title="GitHub">
                        <i class="fab fa-github" aria-hidden="true"></i><span class="sr-only">GitHub</span>
                    </a>
                    <a href="mailto:hello@krakend.io" target="_blank" title="Send us an email">
                        <i class="fa fa-envelope" aria-hidden="true"></i><span class="sr-only">Mail</span>
                    </a>
                </div>

            </div>

                <div class="col-md-2 offset-md-1">
                    <h6>by Devops Faith</h6>
                    <ul class="list-unstyled">
                        
                        <li><a href="http://devops.faith">Devops Faith</a></li>
                        <li><a href="https://www.krakend.io/blog/">Blog</a></li>
                        <li><a href="https://medium.com/devops-faith">Medium</a></li>
                        <li><a href="mailto:hello@krakend.io">Contact Us</a></li>
                    </ul>
                    <h6>More products</h6>
                    <ul class="list-unstyled">
                        <li><a href="http://api2html.com">API2HTML</a></li>
                    </ul>

                </div>
                <div class="col-md-2">
                    <h6>KrakenD</h6>
                    <ul class="list-unstyled">
                        <li><a href="https://www.krakend.io/features/">Features</a></li>
                        <li><a href="https://www.krakend.io/docs/benchmarks/overview/">Benchmarks</a></li>
                        <li><a href="https://www.krakend.io/download/">Download</a></li>
                        <li><a href="https://www.krakend.io/blog/">KrakenD Blog</a></li>
                        <li><a href="https://www.krakend.io/team/">Team</a></li>


                    </ul>

                </div>
                <div class="col-md-2">
                    <h6>Support</h6>
                    <ul class="list-unstyled">
                        <li><a href="https://www.krakend.io/docs/overview/introduction">Documentation</a></li>
                        <li><a href="https://github.com/devopsfaith/krakend" target="_blank">Open Source</a></li>
                        <li><a href="https://github.com/devopsfaith/krakend/issues">Report a problem</a></li>
                        <li><a href="https://www.krakend.io/support/">Support</a></li>
                        

                    </ul>
                </div>

        </div>
        <div class="row copyright">
            <div class="col-md-5 additional-links">
                <strong>Copyright &copy; 2017-2019 <a href="http://devops.faith">Devops Faith</a>.</strong> All rights reserved.
            </div>
            <div class="col-md-7 hidden-xs">
                <span class="float-right">
                    Made with <i class="fa fa-heart heart"></i> in Barcelona by <a href="https://twitter.com/devopsfaith">
                    <img height="30px" src="/images/devops-faith-logo-inverse.png" />
                </span>
                </a>
            </div>
        </div>
    </div>
</footer>

<div class="pea_cook_wrapper pea_cook_bottom" style="display:none">
    <p>We use cookies to understand how you use our site and to improve your overall experience. By continuing to use our site, you accept our Privacy Policy. <a data-toggle="modal" data-target="#cookiesConsent" style="color:#0a0a0a;"
            href="#">More information</a>
        <button class="btn btn-primary btn-sm ml-2 ACCEPT_COOKIES" href="#">Accept</button>
    </p>
</div>


<div class="modal fade" id="cookiesConsent" tabindex="-1" role="dialog" aria-labelledby="cookiesConsentLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="cookiesConsentLabel">Cookies</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>In order to give you the best experience, we use cookies and similar technologies for performance, analytics and marketing. Want to know more?</p>
                <p><a href="/privacy-policy/">Privacy Policy</a></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary ACCEPT_COOKIES" data-dismiss="modal">
                    Accept cookies</button>
            </div>
        </div>
    </div>
</div>


    
<script type="application/javascript">
var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
var doNotTrack = (dnt == "1" || dnt == "yes");
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-87994359-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



    <script src="/dist/krakend-io.js"></script>
<script async defer src="https://buttons.github.io/buttons.js"></script>
    
</body>

</html>